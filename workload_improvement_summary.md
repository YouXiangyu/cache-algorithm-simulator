# 负载测试总结报告

**更新时间：2025-01-21**

## 测试概述

本报告汇总了两种负载集的测试结果：
1. **旧负载集**：`trace_suite.py` 中的9种负载（OLD_WL01-OLD_WL09）
2. **新负载集**：`design_new_workloads.py` 中的7种负载（NEW_WL01-NEW_WL07，已删除WL08和WL09）

所有测试使用32页缓存大小，50000次请求。

## 旧负载集测试结果（trace_suite.py）

### 所有负载汇总

| 负载 | LRU | LFU | FIFO | ARC | OPT | 2Q | 差异 | 备注 |
|------|-----|-----|------|-----|-----|----|----|------|
| **OLD_WL01_HOT10_80_20** | 75.96% | 69.24% | 75.96% | 75.91% | 82.66% | 80.70% | 13.41% | LFU优势场景，但差异小 |
| **OLD_WL02_HOT20_60_40** | 46.20% | **53.88%** | 46.20% | **53.88%** | 75.36% | 47.73% | 29.16% | LFU优势场景 |
| **OLD_WL03_EHOT2_90_10** | 88.04% | 88.28% | 88.04% | 88.28% | 95.54% | 88.04% | 7.50% | 所有算法表现相近 |
| **OLD_WL04_SW32** | **96.81%** | 7.02% | **96.81%** | **96.81%** | 96.82% | 93.66% | 89.80% | LRU优势场景，差异大 |
| **OLD_WL05_SW40** | 0.00% | 0.00% | 0.00% | 0.00% | 79.94% | 0.00% | 79.94% | 所有算法0%，只有OPT好 |
| **OLD_WL06_SW32_STEP2** | **87.45%** | 6.26% | **87.45%** | **87.44%** | 87.55% | 74.94% | 81.30% | LRU优势场景，差异大 |
| **OLD_WL07_HOT20_SCAN48000** | 59.96% | 60.00% | 59.96% | 60.00% | 60.00% | 59.96% | 0.04% | 所有算法表现相同 |
| **OLD_WL08_SCAN_SANDWICH** | 17.92% | 17.96% | 17.92% | 17.96% | 18.00% | 17.92% | 0.08% | 所有算法表现相同 |
| **OLD_WL09_AB_HOT_SW32** | 54.08% | **73.27%** | 53.81% | 55.90% | 78.08% | 65.88% | 24.27% | LFU优势场景 |

### 旧负载集分析

**问题：**
- WL05：所有算法命中率0%，只有OPT表现好（79.94%），差异大但无意义
- WL07、WL08：所有算法表现完全相同，差异极小（0.04%、0.08%），无法区分算法
- WL01、WL03：差异小（13.41%、7.50%），算法表现相近

**优点：**
- WL04、WL06：差异大（89.80%、81.30%），能明显区分LRU和LFU
- WL02、WL09：能体现LFU的优势

## 新负载集测试结果（design_new_workloads.py）

### 所有负载汇总

| 负载 | LRU | LFU | FIFO | ARC | OPT | 2Q | 差异 | 备注 |
|------|-----|-----|------|-----|-----|----|----|------|
| **NEW_WL01_STATIC_FREQ** | 82.59% | **84.16%** | 78.19% | 81.49% | 89.91% | 82.46% | 11.72% | LFU优势场景，但差异小 |
| **NEW_WL02_OSC_FREQ** | 72.74% | **73.02%** | 71.68% | 72.83% | 84.04% | 72.96% | 12.36% | LFU优势场景，但差异小 |
| **NEW_WL03_STATIC_SW** | **96.38%** | 6.25% | **96.38%** | **96.38%** | 96.41% | 92.79% | 90.16% | LRU优势场景，差异大 |
| **NEW_WL04_OSC_SW** | **48.24%** | 5.91% | **48.24%** | 48.56% | 83.52% | 46.78% | 77.61% | LRU优势场景，差异大 |
| **NEW_WL05_SEQUENTIAL** | 25.00% | 29.99% | 25.00% | 29.99% | 87.94% | 25.00% | 62.94% | 只有OPT好，其他算法相近 |
| **NEW_WL06_SCAN_HOT_OSC** | 67.00% | 69.99% | 67.00% | 69.99% | 70.05% | 69.99% | 3.05% | 所有算法表现相近 |
| **NEW_WL07_SCAN_SANDWICH** | 32.80% | 36.99% | 32.80% | 36.99% | 36.99% | 32.80% | 4.19% | 所有算法表现相近 |

### 新负载集分析

**问题：**
- WL05：只有OPT表现好（87.94%），其他算法表现相近（25-30%），无法区分FIFO优势
- WL06、WL07：所有算法表现相近，差异极小（3.05%、4.19%），无法区分2Q优势
- WL01、WL02：差异小（11.72%、12.36%），算法表现相近

**优点：**
- WL03、WL04：差异大（90.16%、77.61%），能明显区分LRU和LFU
- 所有负载的ARC命中率都在合理范围内（29.99%-81.49%）

## 对比分析

### 差异对比

| 负载类型 | 旧负载集 | 新负载集 | 说明 |
|---------|---------|---------|------|
| **LRU优势场景** | WL04: 89.80%<br>WL06: 81.30% | WL03: 90.16%<br>WL04: 77.61% | 新负载集保持了良好的差异 |
| **LFU优势场景** | WL02: 29.16%<br>WL09: 24.27% | WL01: 11.72%<br>WL02: 12.36% | 新负载集差异较小 |
| **2Q优势场景** | WL07: 0.04%<br>WL08: 0.08% | WL06: 3.05%<br>WL07: 4.19% | 两者都无法有效区分2Q优势 |
| **极端情况** | WL05: 79.94%<br>（所有算法0%） | WL05: 62.94%<br>（只有OPT好） | 两者都有问题 |

### ARC表现对比

| 负载集 | ARC命中率范围 | 平均命中率 | 表现 |
|--------|--------------|-----------|------|
| **旧负载集** | 0.00% - 96.81% | 54.42% | 有极端情况（0%） |
| **新负载集** | 29.99% - 96.38% | 60.38% | 更稳定，无极端低值 |

## 总结

### 新负载集的改进

1. ✅ **消除了极端情况**：新负载集没有出现所有算法命中率0%的情况
2. ✅ **ARC表现更稳定**：新负载集中ARC命中率都在30%以上
3. ✅ **保持了LRU优势场景的差异**：WL03、WL04差异明显（90.16%、77.61%）

### 仍需改进的问题

1. ❌ **LFU优势场景差异小**：WL01、WL02差异只有11-12%，算法表现相近
2. ❌ **2Q优势场景无法区分**：WL06、WL07所有算法表现相近，无法体现2Q优势
3. ❌ **FIFO优势场景无法区分**：WL05只有OPT表现好，其他算法相近

### 建议

1. **保留WL03、WL04**：这两个负载能有效区分LRU和LFU，差异明显
2. **改进WL01、WL02**：需要增加噪声干扰，让LRU表现更差，LFU优势更明显
3. **重新设计WL05-WL07**：需要更激进的设计，让FIFO和2Q的优势更明显

## 使用说明

运行 `python test_all_workloads.py` 可以测试所有负载。

如果需要将这些负载集成到 `trace_suite.py` 中，需要：
1. 将负载函数添加到 `trace_suite.py`
2. 在 `TRACE_RECIPES` 中注册
3. 更新相关引用
